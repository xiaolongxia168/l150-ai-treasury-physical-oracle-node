#!/bin/bash
#
# 商家平台功能探索向导
# 指导用户逐一探索抖音来客和美团开店宝的所有功能模块
#

set -e

echo "
╔══════════════════════════════════════════════════════════════════╗
║         🚀 商家平台深度功能探索向导                               ║
║         抖音来客 + 美团开店宝 全模块自动化                        ║
╚══════════════════════════════════════════════════════════════════╝
"

# 颜色定义
RED='\033[0;31m'
GREEN='\033[0;32m'
YELLOW='\033[1;33m'
BLUE='\033[0;34m'
NC='\033[0m' # No Color

# 日志函数
log_info() {
    echo -e "${BLUE}[INFO]${NC} $1"
}

log_success() {
    echo -e "${GREEN}[SUCCESS]${NC} $1"
}

log_warn() {
    echo -e "${YELLOW}[WARN]${NC} $1"
}

log_error() {
    echo -e "${RED}[ERROR]${NC} $1"
}

# 抖音来客探索模块
explore_douyin() {
    echo "
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
📱 抖音来客 - 功能模块探索指南
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
"
    
    log_info "请按以下顺序逐一探索每个功能模块："
    
    echo "
【模块 1/10】首页仪表盘 ✅ (已完成基础抓取)
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
操作：保持当前页面
观察：成交金额、成交券数、核销金额、退款金额
      商品访问人数、经营分、账户余额、本地推消耗
      在售商品数、抖音号粉丝、员工数、违规状态
      消息数量、咨询数量

【模块 2/10】推广中心 - 本地推 🚀
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
操作步骤：
  1. 点击左侧菜单【推广】或【本地推】
  2. 记录页面URL (例如: https://life.douyin.com/promotion/...)
  3. 查看以下数据：
     □ 推广预算设置
     □ 今日消耗金额
     □ 曝光量/点击量/点击率
     □ 转化量/转化率/ROI
     □ 推广计划列表
     □ 人群定向设置
     □ 创意素材表现

【模块 3/10】商品管理 🛍️
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
操作步骤：
  1. 点击【商品】或【商品管理】
  2. 记录页面URL
  3. 查看以下数据：
     □ 全部商品数量
     □ 出售中/已售罄/审核中/已下架数量
     □ 每个商品的浏览量
     □ 每个商品的销量
     □ 商品转化率
     □ 库存状态

【模块 4/10】订单管理 💰
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
操作步骤：
  1. 点击【订单】或【交易管理】
  2. 记录页面URL
  3. 查看以下数据：
     □ 待核销订单数
     □ 今日已核销数
     □ 退款中订单数
     □ 订单金额分布
     □ 用户来源分析

【模块 5/10】核销管理
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
操作步骤：
  1. 点击【核销】或【验券】
  2. 记录页面URL
  3. 查看以下数据：
     □ 今日核销数量
     □ 核销金额
     □ 核销时间分布
     □ 核销员统计

【模块 6/10】评价管理 ⭐
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
操作步骤：
  1. 点击【评价】或【评价管理】
  2. 记录页面URL
  3. 查看以下数据：
     □ 全部评价数
     □ 今日新增评价
     □ 差评数量 (重点关注！)
     □ 待回复评价数
     □ 综合评分
     □ 各维度评分

【模块 7/10】客户管理 👥
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
操作步骤：
  1. 点击【客户】或【客户管理】
  2. 记录页面URL
  3. 查看以下数据：
     □ 客户总数
     □ 今日新增客户
     □ 回头客数量
     □ 高价值客户
     □ 客户消费频次
     □ 客户流失预警

【模块 8/10】数据中心 📊
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
操作步骤：
  1. 点击【数据】或【数据中心】
  2. 记录页面URL
  3. 查看以下数据：
     □ 流量来源分布 (自然/付费/搜索)
     □ 访问转化漏斗
     □ 高峰时段分析
     □ 周环比/月环比
     □ 商品表现排行
     □ 客户行为分析

【模块 9/10】财务管理 💳
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
操作步骤：
  1. 点击【财务】或【资金】
  2. 记录页面URL
  3. 查看以下数据：
     □ 账户总余额
     □ 收入明细
     □ 提现记录
     □ 对账中心

【模块 10/10】店铺装修 🎨
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
操作步骤：
  1. 点击【店铺】或【店铺装修】
  2. 记录页面URL
  3. 查看以下设置：
     □ 店铺头图
     □ 店铺公告
     □ 营业时间
     □ 联系方式
"
}

# 美团开店宝探索模块
explore_meituan() {
    echo "
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
🍜 美团开店宝 - 功能模块探索指南
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
"
    
    log_info "请按以下顺序逐一探索每个功能模块："
    
    echo "
【模块 1/10】首页仪表盘 ✅ (已完成基础抓取)
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
操作：保持当前页面
观察：访问人数、下单金额、核销金额
      经营评分、新增评论/差评
      通知消息数量

【模块 2/10】推广通 🚀
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
操作步骤：
  1. 点击【推广】或【推广通】
  2. 记录页面URL
  3. 查看以下数据：
     □ 推广预算
     □ 今日消耗
     □ 展现量/点击量
     □ 平均点击单价 (CPC)
     □ 平均排名
     □ 投入产出比 (ROI)
     □ 推广计划列表

【模块 3/10】店铺管理 🏪
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
操作步骤：
  1. 点击【店铺】或【店铺管理】
  2. 记录页面URL
  3. 查看以下设置：
     □ 店铺头图
     □ 相册图片
     □ 商家故事
     □ 营业时间设置
     □ 门店信息

【模块 4/10】团购管理 🎫
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
操作步骤：
  1. 点击【团购】或【团购管理】
  2. 记录页面URL
  3. 查看以下数据：
     □ 全部团购数量
     □ 出售中/已下架数量
     □ 每个团购的浏览量
     □ 每个团购的销量
     □ 团购转化率
     □ 团购排名

【模块 5/10】交易管理 💰
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
操作步骤：
  1. 点击【交易】或【订单管理】
  2. 记录页面URL
  3. 查看以下数据：
     □ 待消费订单
     □ 已消费订单
     □ 退款订单
     □ 验券记录
     □ 订单金额分布

【模块 6/10】评价管理 ⭐
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
操作步骤：
  1. 点击【评价】或【评价管理】
  2. 记录页面URL
  3. 查看以下数据：
     □ 全部评价数
     □ 5星/4星/3星/2星/1星分布
     □ 新增差评 (重点关注！)
     □ 待回复评价
     □ 各维度评分 (环境/服务/口味)
     □ 评价回复率

【模块 7/10】顾客管理 👥
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
操作步骤：
  1. 点击【顾客】或【顾客管理】
  2. 记录页面URL
  3. 查看以下数据：
     □ 顾客总数
     □ 新老顾客比例
     □ 会员数量
     □ 顾客消费行为
     □ 顾客留存率

【模块 8/10】数据中心 📊
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
操作步骤：
  1. 点击【数据】或【经营分析】
  2. 记录页面URL
  3. 查看以下数据：
     □ 商圈排名
     □ 流量趋势
     □ 访问转化率
     □ 客单价
     □ 与竞品对比
     □ 流量来源分析

【模块 9/10】财务管理 💳
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
操作步骤：
  1. 点击【财务】或【资金管理】
  2. 记录页面URL
  3. 查看以下数据：
     □ 账户余额
     □ 收支明细
     □ 结算周期
     □ 结算记录

【模块 10/10】营销活动 🎁
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
操作步骤：
  1. 点击【营销】或【活动中心】
  2. 记录页面URL
  3. 查看以下数据：
     □ 可报名平台活动
     □ 已参与活动
     □ 活动效果数据
     □ 优惠券设置
     □ 满减活动
"
}

# 使用说明
show_usage() {
    echo "
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
📖 使用说明
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━

用法: $0 [选项]

选项:
  douyin    显示抖音来客功能探索指南
  meituan   显示美团开店宝功能探索指南  
  all       显示完整探索指南 (默认)
  help      显示帮助信息

示例:
  $0              # 显示完整指南
  $0 douyin       # 仅显示抖音来客指南
  $0 meituan      # 仅显示美团开店宝指南

━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
🎯 探索流程建议
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━

第1步: 在浏览器中登录抖音来客后台
       URL: https://life.douyin.com/

第2步: 按指南逐一探索每个模块
       记录每个模块的URL和数据结构

第3步: 对美团开店宝重复同样操作
       URL: https://e.dianping.com/

第4步: 将记录的URL和选择器反馈给我
       我会更新采集系统的配置

第5步: 运行完整采集系统
       node scraper-v2.js all

━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
💡 提示
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━

• 保持浏览器页面打开，不要关闭
• 每个模块探索后，复制URL到文档中
• 截图重要的数据页面
• 注意记录数据的格式和单位
• 重点关注P0优先级模块 (推广、评价、订单)

"
}

# 主程序
main() {
    case "${1:-all}" in
        douyin)
            explore_douyin
            ;;
        meituan)
            explore_meituan
            ;;
        all)
            explore_douyin
            echo "
按下回车键继续探索美团开店宝..."
            read
            explore_meituan
            ;;
        help|--help|-h)
            show_usage
            ;;
        *)
            log_error "未知选项: $1"
            show_usage
            exit 1
            ;;
    esac
    
    echo "
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
✅ 探索指南生成完成
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━

下一步行动：
1. 打开抖音来客后台 (https://life.douyin.com/)
2. 按照指南逐一探索每个功能模块
3. 记录每个模块的URL和数据结构
4. 完成后告诉我，我会更新采集系统

"
}

# 运行
main "$@"
