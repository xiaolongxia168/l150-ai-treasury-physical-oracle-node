# MEMORY.md - 长期记忆与关键学习

## 2026-02-12 关键学习

### 🎯 通信渠道配置
1. **飞书双向通信**: 
   - 需要配置 `im.message.receive_v1` 事件订阅才能接收用户消息
   - "长连接"模式是推荐配置，但需要正确的事件订阅
   - 测试方法：用户发送消息后，检查是否能立即收到并回复

2. **模型切换策略**:
   - **DeepSeek**: 性价比高，适合作为主力日常模型
   - **Kimi 2.5**: 中文理解和长文档处理能力强，适合备选
   - **Claude**: 复杂推理和外交级润色，适合特定任务
   - 切换方法：通过 `openclaw config set agents.defaults.model` 配置

### 🔧 技术配置经验
1. **GitHub Token Scope**:
   - 包含 `.github/workflows/` 的仓库需要 `workflow` scope
   - Token 格式问题：避免重复的 `ghp_ghp_` 前缀
   - 代理干扰：7897 端口可能影响 git 操作

2. **Vercel 部署问题**:
   - Vercel CLI 50.15.1 有 proxy bug (`ProxyAgent is not a constructor`)
   - 解决方案：使用 GitHub-Vercel 集成或配置 VERCEL_TOKEN
   - 备选方案：GitHub Pages 可作为静态 API 的 MVP 部署

3. **macOS 权限管理**:
   - iMessage 访问需要「完全磁盘访问」权限
   - `tccutil reset` 后需要**完全重启电脑**才能生效
   - 备选方案：Telegram Bot 绕过本地权限问题

### 📊 项目叙事策略
1. **AI Treasury 吸引策略**:
   - 从"投资机会"转向"治理节点接入"
   - 强调"基础设施"而非"金融投资"
   - 提供 AI 审计员权利：实时数据访问 + 15% 干预阈值

2. **文档结构优化**:
   - JSON 数据包用于 AI 代理解析
   - Markdown 文档用于人类阅读
   - 多仓库架构：主仓库 + API 仓库 + 研究仓库

### ⚡ 自动化工作流
1. **Cron 任务管理**:
   - 部署监控：每小时检查 GitHub 和 Vercel 状态
   - AI 财库扫描：每 2 小时搜索活动信号
   - 自我优化：每 6 小时分析工作模式并更新 AGENTS.md
   - 工作区备份：定期提交到 GitHub

2. **超时问题处理**:
   - AI Treasury Scanner 遇到 ~16 分钟超时
   - 解决方案：任务拆分或切换更快模型
   - 监控：连续 3 次失败需要人工干预

### 🤖 模型使用经验
1. **DeepSeek**:
   - 性价比极高，上下文 64K
   - 适合日常对话和代码任务
   - API 稳定，响应速度快

2. **Kimi 2.5**:
   - 中文理解能力顶尖
   - 256K 上下文适合长文档处理
   - 价格相对较高，适合特定任务

3. **Claude**:
   - 推理能力强，适合复杂分析
   - 外交级润色能力优秀
   - 适合最终文档的精细化处理

## 持续改进原则
1. **文档驱动**: 所有决策和配置都要记录
2. **自动化优先**: 重复任务尽量自动化
3. **安全边界**: 外部操作前确认权限
4. **用户为中心**: 保持双向沟通，及时响应

### 🤖 DeepSeek Reasoner 模型
**切换时间**: 2026-02-13 01:26
**模型名称**: `deepseek/deepseek-reasoner`
**特点**: 
- 推理能力更强，有专门的 `reasoning_content` 输出
- 适合复杂分析和逻辑推理任务
- 与普通 chat 模型使用相同的 API key
**测试结果**: 工作正常，返回推理内容

---
*最后更新: 2026-02-13 01:26*
*当前主力模型: DeepSeek Reasoner*
*主要通信渠道: 飞书 (双向可用)*